<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rekap Absensi Sekolah - Scratch Management</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="style_materi.css" />
</head>
<body class="bg-app">

  <header class="app-header no-print">
    <div class="header-content">
      <h1 style="font-family: var(--font-heading);">REKAP ABSENSI SISWA</h1>
    </div>
    <nav class="nav-actions">
      <a href="dashboard.html" class="btn-nav"> Dashboard</a>
      <a href="absensi_sekolah.html" class="btn-nav"> Kelas</a>
    </nav>
  </header>

  <main class="content-container">
    
    <section class="search-section card shadow-soft no-print">
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; align-items: end;">
        <div class="form-group"><label>Tahun Ajaran</label><select id="academicYearSelect" class="input-pro"></select></div>
        <div class="form-group"><label>Semester</label><select id="semesterSelect" class="input-pro"></select></div>
        <div class="form-group"><label>Pilih Kelas</label><select id="classSelect" class="input-pro"></select></div>
        <div class="form-group"><button id="loadRekap" class="btn-primary" style="width: 100%;">TAMPILKAN</button></div>
      </div>
    </section>

    <div class="rekap-header card shadow-soft" style="text-align: center; margin-bottom: 20px;">
        <h2 id="schoolName" style="font-family: var(--font-heading); color: var(--scratch-blue);">-</h2>
        <p style="margin: 5px 0; font-weight: bold;">Tahun Ajaran: - &nbsp;&nbsp; Semester: -</p>
        <p style="margin: 5px 0;">Kelas: - &nbsp;&nbsp; Jadwal: -</p>
    </div>

    <div class="card shadow-soft no-print" style="padding: 15px; margin-bottom: 20px;">
      <div style="display: flex; flex-wrap: wrap; gap: 15px; align-items: center; justify-content: space-between;">
        <div style="display: flex; gap: 8px;">
          <button id="btnRekapAbsensi" class="btn-nav active"> Rekap Absensi</button>
          <button id="btnRekapPembelajaran" class="btn-nav"> Rekap Pembelajaran</button>
        </div>
        <div style="display: flex; align-items: center; gap: 10px;">
          <label>Rentang:</label>
          <select id="pertemuanStartSelect" class="input-pro" style="width: 80px;"></select>
          <span>s/d</span>
          <select id="pertemuanEndSelect" class="input-pro" style="width: 80px;"></select>
          <button id="exportExcel" class="btn-primary" style="background: var(--scratch-green);"> Excel</button>
          <button id="printRekap" class="btn-primary" style="background: var(--scratch-blue);"> Cetak</button>
        </div>
      </div>
    </div>

    <div class="table-scroll shadow-soft" style="background: white; border-radius: var(--radius-md); overflow-x: auto; padding: 10px;">
      <section id="tabelSiswaSection" class="rekap-section"><table id="tabelDataSiswa" class="rigid-table"></table></section>
      <section id="rekapAbsensiSection" class="rekap-section" style="display: none;"><table id="rekapAbsensiTable" class="rigid-table"></table></section>
      <section id="rekapPembelajaranSection" class="rekap-section" style="display: none;"><table id="rekapPembelajaranTable" class="rigid-table"></table></section>
    </div>

  </main>
  <script type="module" src="auth_guard.js"></script>
  <script src="rekap_absensi_sekolah.js" type="module"></script>
</body>

</html>
